FROM ocaml-camlsnark:latest

RUN eval `opam config env` && opam install yojson

WORKDIR /testbridge

ADD ./ /testbridge
ADD ./testbridge.opam.in /testbridge/testbridge.opam

RUN sudo mkdir /app

RUN sudo chown -R opam /testbridge

RUN eval `opam config env` && jbuilder build

RUN sudo chown -R opam /app

CMD bash -c "while true; do ./_build/install/default/bin/container_camlsnark; sleep 1; done"


